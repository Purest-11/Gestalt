# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ‘ï¸ åŒæœºæ¨¡å¼ - è§†è§‰æœºé…ç½®
# 
# è§†è§‰æœºèŒè´£ï¼šè§‚ä¼—è§¦æ‘¸äº¤äº’ + ç²’å­æŠ•å½± + å…¬ç½‘éš§é“ï¼ˆå¯é€‰ï¼‰
# 
# ä½¿ç”¨æ–¹æ³•ï¼š
#   # æœ¬åœ°è§‚ä¼—ï¼ˆåŒä¸€ WiFiï¼‰
#   docker-compose -f docker-compose.dual-visual.yml up -d
#
#   # å…¬ç½‘è§‚ä¼—ï¼ˆCloudflareï¼‰
#   docker-compose -f docker-compose.dual-visual.yml -f docker-compose.tunnel.yml up -d
#
#   # å…¬ç½‘è§‚ä¼—ï¼ˆcpolar å›½å†…ï¼‰
#   docker-compose -f docker-compose.dual-visual.yml -f docker-compose.cpolar.yml up -d
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version: '3.8'

services:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ğŸ‘¥ è§‚ä¼—ç³»ç»Ÿï¼ˆç«¯å£ 3002ï¼ŒOSC 7402ï¼‰
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  audience:
    build: .
    container_name: osc-visual-dual
    restart: unless-stopped
    ports:
      # Web æœåŠ¡
      - "3002:3002"
      # OSC UDP ç«¯å£
      - "7402:7402/udp"
    environment:
      - NODE_ENV=production
      - PORT=3002
      - OSC_PORT=7402
      - PERFORMER_ID=audience
      # ğŸ”‘ å…³é”®é…ç½®ï¼šå¯ç”¨ UDP å¹¿æ’­
      # è¿™æ ·æ¼”å‘˜æœºçš„ Max MSP å¯ä»¥é€šè¿‡å±€åŸŸç½‘æ¥æ”¶åˆ°è§‚ä¼—æ•°æ®
      - USE_BROADCAST=true
    extra_hosts:
      - "host.docker.internal:host-gateway"
    volumes:
      - ./logs/audience:/app/logs
    networks:
      - osc-network
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3002/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ç½‘ç»œé…ç½®
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
networks:
  osc-network:
    driver: bridge

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ä½¿ç”¨è¯´æ˜
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ–¥ï¸ åŒæœºæ¨¡å¼æ¶æ„ï¼š
#
#   æ¼”å‘˜æœºï¼ˆç”µè„‘ Aï¼‰              è§†è§‰æœºï¼ˆç”µè„‘ Bï¼‰
#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#   â”‚ MediaPipe åŠ¨æ•   â”‚          â”‚ è§‚ä¼—è§¦æ‘¸ç³»ç»Ÿ    â”‚
#   â”‚ Max MSP         â”‚â—„â”€UDPâ”€â”€â”€  â”‚ ç²’å­æŠ•å½±        â”‚
#   â”‚ [udpreceive 7402]â”‚  å¹¿æ’­   â”‚ (Docker è¿è¡Œ)   â”‚
#   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# ğŸ“‹ å‰ç½®æ¡ä»¶ï¼š
#   1. ä¸¤å°ç”µè„‘è¿æ¥åŒä¸€ WiFi
#   2. æ¼”å‘˜æœºå·²å¯åŠ¨ï¼ˆä½¿ç”¨ ./start.sh â†’ é€‰é¡¹ 4ï¼‰
#   3. æ¼”å‘˜æœº Max MSP å·²åˆ›å»º [udpreceive 7402]
#
# ğŸš€ å¯åŠ¨è§†è§‰æœºï¼š
#
#   # æ–¹å¼ 1ï¼šæœ¬åœ°è§‚ä¼—ï¼ˆåŒä¸€ WiFiï¼‰
#   docker-compose -f docker-compose.dual-visual.yml up -d
#
#   # æ–¹å¼ 2ï¼šå…¬ç½‘è§‚ä¼— - Cloudflareï¼ˆå›½å¤–ï¼‰
#   docker-compose -f docker-compose.dual-visual.yml -f docker-compose.tunnel.yml up -d
#
#   # æ–¹å¼ 3ï¼šå…¬ç½‘è§‚ä¼— - cpolarï¼ˆå›½å†…ï¼‰
#   # é¦–å…ˆé…ç½® authtokenï¼ˆä»…éœ€ä¸€æ¬¡ï¼‰ï¼š
#   docker run --rm -v cpolar-config:/root/.cpolar probezy/cpolar authtoken ä½ çš„TOKEN
#   # ç„¶åå¯åŠ¨ï¼š
#   docker-compose -f docker-compose.dual-visual.yml -f docker-compose.cpolar.yml up -d
#
# ğŸ“ è®¿é—®åœ°å€ï¼š
#   æŠ•å½±ç›‘æ§é¢æ¿: http://localhost:3002/?performer=audience
#   è§‚ä¼—æœ¬åœ°å…¥å£: http://è§†è§‰æœºIP:3002/audience-touch/
#   è§‚ä¼—å…¬ç½‘å…¥å£: æŸ¥çœ‹éš§é“æ—¥å¿—è·å– URL
#
# ğŸ“¡ OSC æ•°æ®æµï¼š
#   è§‚ä¼—è§¦æ‘¸ â†’ è§†è§‰æœº(3002) â†’ UDP å¹¿æ’­ :7402 â†’ æ¼”å‘˜æœº Max MSP
#
# ğŸ›‘ åœæ­¢ï¼š
#   docker-compose -f docker-compose.dual-visual.yml down
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

